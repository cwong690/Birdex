{% extends 'layout.html' %}

{% block chart %}

<canvas id="moreChart" width="1000px" height="700px"></canvas>

    <script>
    // get chart canvas
    var ctx = document.getElementById('moreChart');
        
    var chartData = {
      labels : [{% for label in species_index %}
                 "{{label}}",
                {% endfor %}],
      datasets : [{
          label: '{{ legend }}',
          fill: true,
          lineTension: 0.1,
          backgroundColor: [
                'rgba(255, 206, 86, 0.2)',
                'rgba(255, 99, 132, 0.2)',
                'rgba(54, 162, 235, 0.2)',
                'rgba(75, 192, 192, 0.2)'
          ],
          borderColor: [
                'rgba(255, 206, 86, 1)',
                'rgba(255, 99, 132, 1)',
                'rgba(54, 162, 235, 1)',
                'rgba(75, 192, 192, 1)'
          ],
          borderCapStyle: 'butt',
          borderDash: [],
          borderDashOffset: 0.0,
          borderJoinStyle: 'miter',
          pointBorderColor: "rgba(75,192,192,1)",
          pointBackgroundColor: "#fff",
          pointBorderWidth: 1,
          pointHoverRadius: 5,
          pointHoverBackgroundColor: "rgba(75,192,192,1)",
          pointHoverBorderColor: "rgba(220,220,220,1)",
          pointHoverBorderWidth: 2,
          pointRadius: 1,
          pointHitRadius: 10,
          data : [{{ species_count }}],
          spanGaps: false
      }]
    }

    // create the chart using the chart canvas    
    var moreChart = new Chart(ctx, {
      type: 'bar',
      data: chartData,
      options: {
          responsive: false,
          tooltips: {
            enabled: true,
            mode: 'single',
            callbacks: {
              label: function(tooltipItems, data) {
                       return tooltipItems.yLabel + ' risks';
                     }
          }
        },
      }
    });


    // get chart canvas
    var holder = document.getElementById("moreChart");

    // Next, a variable is created for identifying the text to be updated:
    // get the text element below the chart
    var pointSelected = document.getElementById("pointSelected");

    // create a callback function for updating the selected index on the chart
    holder.onclick = function(evt){
      var activePoint = moreChart.getElementAtEvent(evt);
     pointSelected.innerHTML = 'Point selected... index: ' + activePoint[0]._index;
    };



//     console.log(activePoint);
//     console.log('x:' + activePoint[0]._view.x);
//     console.log('maxWidth: ' + activePoint[0]._xScale.maxWidth);
//     console.log('y: ' + activePoint[0]._view.y);

{% endblock %}